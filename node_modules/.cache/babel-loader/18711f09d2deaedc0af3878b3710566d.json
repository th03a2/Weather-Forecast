{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useDocumentLoader = void 0;\n\nvar react_1 = require(\"react\");\n\nvar state_1 = require(\"../state\");\n\nvar actions_1 = require(\"../state/actions\");\n\nvar fileLoaders_1 = require(\"./fileLoaders\");\n\nvar useRendererSelector_1 = require(\"./useRendererSelector\");\n/**\n * Custom Hook for loading the current document into context\n */\n\n\nexports.useDocumentLoader = function () {\n  var _a = react_1.useContext(state_1.DocViewerContext),\n      state = _a.state,\n      dispatch = _a.dispatch;\n\n  var currentFileNo = state.currentFileNo,\n      currentDocument = state.currentDocument;\n  var CurrentRenderer = useRendererSelector_1.useRendererSelector().CurrentRenderer;\n  var documentURI = (currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.uri) || \"\";\n  react_1.useEffect(function () {\n    if (!currentDocument) return;\n    if (currentDocument.fileType !== undefined) return;\n    var controller = new AbortController();\n    var signal = controller.signal;\n    fetch(documentURI, {\n      method: \"HEAD\",\n      signal: signal\n    }).then(function (response) {\n      var contentTypeRaw = response.headers.get(\"content-type\");\n      var contentTypes = (contentTypeRaw === null || contentTypeRaw === void 0 ? void 0 : contentTypeRaw.split(\";\")) || [];\n      var contentType = contentTypes.length ? contentTypes[0] : undefined;\n      dispatch(actions_1.updateCurrentDocument(__assign(__assign({}, currentDocument), {\n        fileType: contentType || undefined\n      })));\n    });\n    return function () {\n      controller.abort();\n    };\n  }, // eslint ignore added, because a warning appears for dispatch to\n  // be a dependancy of the useEffect\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  [currentFileNo, documentURI]);\n  react_1.useEffect(function () {\n    var _a;\n\n    if (!currentDocument || CurrentRenderer === undefined) return;\n    var controller = new AbortController();\n    var signal = controller.signal;\n\n    var fileLoaderComplete = function fileLoaderComplete(fileReader) {\n      if (!currentDocument || !fileReader) {\n        dispatch(actions_1.setDocumentLoading(false));\n        return;\n      }\n\n      var updatedDocument = __assign({}, currentDocument);\n\n      if (fileReader.result !== null) {\n        updatedDocument.fileData = fileReader.result;\n      }\n\n      dispatch(actions_1.updateCurrentDocument(updatedDocument));\n      dispatch(actions_1.setDocumentLoading(false));\n    };\n\n    if (CurrentRenderer === null) {\n      dispatch(actions_1.setDocumentLoading(false));\n    } else if (CurrentRenderer.fileLoader !== undefined) {\n      (_a = CurrentRenderer.fileLoader) === null || _a === void 0 ? void 0 : _a.call(CurrentRenderer, {\n        documentURI: documentURI,\n        signal: signal,\n        fileLoaderComplete: fileLoaderComplete\n      });\n    } else {\n      fileLoaders_1.defaultFileLoader({\n        documentURI: documentURI,\n        signal: signal,\n        fileLoaderComplete: fileLoaderComplete\n      });\n    }\n\n    return function () {\n      controller.abort();\n    };\n  }, [CurrentRenderer]);\n  return {\n    state: state,\n    dispatch: dispatch,\n    CurrentRenderer: CurrentRenderer\n  };\n};","map":{"version":3,"sources":["C:/xampp/htdocs/mdbreact/node_modules/react-doc-viewer/build/utils/useDocumentLoader.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","defineProperty","exports","value","useDocumentLoader","react_1","require","state_1","actions_1","fileLoaders_1","useRendererSelector_1","_a","useContext","DocViewerContext","state","dispatch","currentFileNo","currentDocument","CurrentRenderer","useRendererSelector","documentURI","uri","useEffect","fileType","undefined","controller","AbortController","signal","fetch","method","then","response","contentTypeRaw","headers","get","contentTypes","split","contentType","updateCurrentDocument","abort","fileLoaderComplete","fileReader","setDocumentLoading","updatedDocument","result","fileData","fileLoader","defaultFileLoader"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useDocumentLoader = void 0;\nvar react_1 = require(\"react\");\nvar state_1 = require(\"../state\");\nvar actions_1 = require(\"../state/actions\");\nvar fileLoaders_1 = require(\"./fileLoaders\");\nvar useRendererSelector_1 = require(\"./useRendererSelector\");\n/**\n * Custom Hook for loading the current document into context\n */\nexports.useDocumentLoader = function () {\n    var _a = react_1.useContext(state_1.DocViewerContext), state = _a.state, dispatch = _a.dispatch;\n    var currentFileNo = state.currentFileNo, currentDocument = state.currentDocument;\n    var CurrentRenderer = useRendererSelector_1.useRendererSelector().CurrentRenderer;\n    var documentURI = (currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.uri) || \"\";\n    react_1.useEffect(function () {\n        if (!currentDocument)\n            return;\n        if (currentDocument.fileType !== undefined)\n            return;\n        var controller = new AbortController();\n        var signal = controller.signal;\n        fetch(documentURI, { method: \"HEAD\", signal: signal }).then(function (response) {\n            var contentTypeRaw = response.headers.get(\"content-type\");\n            var contentTypes = (contentTypeRaw === null || contentTypeRaw === void 0 ? void 0 : contentTypeRaw.split(\";\")) || [];\n            var contentType = contentTypes.length ? contentTypes[0] : undefined;\n            dispatch(actions_1.updateCurrentDocument(__assign(__assign({}, currentDocument), { fileType: contentType || undefined })));\n        });\n        return function () {\n            controller.abort();\n        };\n    }, \n    // eslint ignore added, because a warning appears for dispatch to\n    // be a dependancy of the useEffect\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [currentFileNo, documentURI]);\n    react_1.useEffect(function () {\n        var _a;\n        if (!currentDocument || CurrentRenderer === undefined)\n            return;\n        var controller = new AbortController();\n        var signal = controller.signal;\n        var fileLoaderComplete = function (fileReader) {\n            if (!currentDocument || !fileReader) {\n                dispatch(actions_1.setDocumentLoading(false));\n                return;\n            }\n            var updatedDocument = __assign({}, currentDocument);\n            if (fileReader.result !== null) {\n                updatedDocument.fileData = fileReader.result;\n            }\n            dispatch(actions_1.updateCurrentDocument(updatedDocument));\n            dispatch(actions_1.setDocumentLoading(false));\n        };\n        if (CurrentRenderer === null) {\n            dispatch(actions_1.setDocumentLoading(false));\n        }\n        else if (CurrentRenderer.fileLoader !== undefined) {\n            (_a = CurrentRenderer.fileLoader) === null || _a === void 0 ? void 0 : _a.call(CurrentRenderer, { documentURI: documentURI, signal: signal, fileLoaderComplete: fileLoaderComplete });\n        }\n        else {\n            fileLoaders_1.defaultFileLoader({ documentURI: documentURI, signal: signal, fileLoaderComplete: fileLoaderComplete });\n        }\n        return function () {\n            controller.abort();\n        };\n    }, [CurrentRenderer]);\n    return { state: state, dispatch: dispatch, CurrentRenderer: CurrentRenderer };\n};\n"]},"metadata":{},"sourceType":"script"}